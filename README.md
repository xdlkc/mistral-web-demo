# Mistral AI 聊天应用

一个基于Flask的Web应用程序，允许用户通过文字或图片与Mistral AI模型进行对话。

## 最近更新

- 📎 **粘贴图片功能** - 现在支持直接从剪贴板粘贴图片到对话框
- 🚀 **端口变更** - 应用端口已从5000更改为5001，避免与macOS AirPlay冲突
- ✨ **历史对话图片展示** - 现在可以在历史对话中直接查看上传的图片
- 🔍 **图片查看功能** - 点击任何图片可以查看大图，支持ESC键关闭
- 🎛️ **界面优化** - 文本/图片模式切换按钮已移至输入框上方，提高了使用体验
- 🎯 **交互优化** - 添加图片悬停效果，优化响应式布局

## 功能特性

- 💬 纯文本对话 - 向Mistral AI发送文字提问并获取回答
- 🖼️ 图片对话 - 上传图片并提问，Mistral AI将分析图片内容
- 📝 连续对话 - 支持上下文连续对话，Mistral AI能理解之前的对话内容
- 📜 历史记录 - 自动保存聊天历史，并支持查看、切换、删除历史会话
- 🎨 美观界面 - 现代化设计的用户界面，支持响应式布局
- 🖼️ 图片显示 - 历史对话中展示上传的图片，支持点击查看大图
- 🔄 便捷切换 - 文本/图片模式切换按钮靠近输入框，使用更方便
- 📋 粘贴图片 - 支持直接从剪贴板粘贴图片，无需保存后上传

## 技术栈

- **后端**: Flask, Python
- **前端**: HTML, CSS, JavaScript, Bootstrap 5
- **AI**: Mistral AI API
- **存储**: 本地文件系统存储

## 安装步骤

1. 克隆仓库:
   ```
   git clone <repo-url>
   cd mistral-app
   ```

2. 安装依赖:
   ```
   pip install -r requirements.txt
   ```

3. 设置环境变量:
   创建一个 `.env` 文件并添加以下内容:
   ```
   MISTRAL_API_KEY=your_api_key_here
   SECRET_KEY=your_secret_key_here
   ```

4. 运行应用:
   ```
   python app.py
   ```

5. 在浏览器中访问:
   ```
   http://127.0.0.1:5001
   ```

## 使用说明

1. **文本对话**: 点击输入框上方的"文本模式"按钮，在输入框中输入问题并发送。
2. **图片对话**: 点击输入框上方的"图片模式"按钮，选择图片并输入关于图片的问题。
3. **粘贴图片**: 在图片模式下，可以直接按Ctrl+V（或Command+V）粘贴剪贴板中的图片。
4. **查看大图**: 点击聊天记录中的任何图片可以查看大图，点击背景或ESC键退出。
5. **新建对话**: 点击左侧边栏中的"新聊天"按钮创建新的对话。
6. **查看历史**: 在左侧边栏中可以看到所有聊天历史，点击任一历史可以继续对话。
7. **删除历史**: 点击聊天历史条目右侧的删除图标可以删除该对话历史。

## 界面操作

- **切换模式**: 输入框上方的按钮可快速切换文本/图片模式
- **上传图片**: 图片模式下点击图片图标选择图片，可预览图片
- **粘贴图片**: 图片模式下直接粘贴剪贴板中的图片（Ctrl+V或Command+V）
- **发送消息**: 点击发送按钮或按回车键发送消息
- **查看大图**: 点击任何图片可放大查看，再次点击或按ESC键退出

## 项目结构

```
mistral-app/
│
├── app/                    # 应用模块
│   └── models/             # 模型定义
│       ├── mistral_client.py  # Mistral API 客户端
│       ├── chat_history.py    # 聊天历史管理
│       └── forms.py           # 表单定义
│
├── static/                 # 静态资源
│   ├── css/                # 样式文件
│   ├── js/                 # JavaScript文件
│   └── uploads/            # 上传的图片
│
├── templates/              # HTML模板
│   ├── base.html           # 基础模板
│   └── index.html          # 首页模板
│
├── chat_history/           # 聊天历史存储目录
├── app.py                  # 应用主文件
├── config.py               # 配置文件
└── requirements.txt        # 依赖列表
```

## 注意事项

- 此应用需要有效的Mistral AI API密钥才能运行
- 上传的图片和聊天历史存储在本地，请确保有足够的磁盘空间
- 默认情况下，应用运行在开发模式并使用5001端口，不建议在生产环境中直接使用
- 如果5001端口被占用，可以在app.py中修改端口号

## 未来计划

- 📱 **移动端优化** - 改进移动设备的交互体验和手势支持
- 🌙 **暗黑模式** - 添加暗黑模式以减轻眼睛疲劳
- ⌨️ **快捷键支持** - 添加键盘快捷键提高使用效率（如Ctrl+Enter发送）
- 🔊 **语音输入** - 支持语音输入文本，提供更自然的交互方式
- 🖌️ **消息编辑** - 允许用户修改或删除已发送的消息
- 📥 **拖放上传** - 支持拖放方式上传图片
- 📋 **代码块复制** - 为代码块添加一键复制功能

## 许可证

[MIT](LICENSE) 